{% extends 'base.html' %}

{% block title %}Regístrate - Domicilios RM{% endblock %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
{% endblock %}

{% block content %}
<div class="flex items-center justify-center min-h-[calc(100vh-160px)] px-4 py-8">
    <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-2xl border border-gray-200">
        
        <h2 class="text-3xl font-bold text-center text-gray-800 mb-2">
            {% if selected_role == 'business' %}
                Registro de Negocio
            {% elif selected_role == 'driver' %}
                Registro de Conductor
            {% endif %}
        </h2>

        <p class="text-center text-gray-600 mb-6">
            {% if selected_role == 'business' %}
                Registra tu negocio y empieza a recibir pedidos.
            {% elif selected_role == 'driver' %}
                Regístrate como conductor y empieza a generar ingresos.
            {% endif %}
        </p>

        <form action="{{ url_for('public.register') }}" method="POST">
            {{ form.hidden_tag() }}

            <!-- Rol forzado -->
            <input type="hidden" name="role" value="{{ selected_role }}">

            <!-- Campos Comunes -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">{{ form.first_name.label }}</label>
                    {{ form.first_name(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800") }}
                </div>

                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">{{ form.last_name.label }}</label>
                    {{ form.last_name(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800") }}
                </div>

                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">{{ form.phone_number.label }}</label>
                    {{ form.phone_number(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800") }}
                </div>

                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">{{ form.email.label }}</label>
                    {{ form.email(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800") }}
                </div>

                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">{{ form.password.label }}</label>
                    {{ form.password(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800") }}
                </div>

                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">{{ form.confirm_password.label }}</label>
                    {{ form.confirm_password(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800") }}
                </div>
            </div>

            <!-- Campos SOLO para Conductores -->
            {% if selected_role == 'driver' %}
            <div class="mt-6 border-t pt-4">
                <h3 class="text-xl font-semibold text-gray-700 mb-4">Información del Vehículo</h3>

                <div class="mb-5">
                    <label class="block text-sm font-medium text-gray-700">{{ form.vehicle_type.label }}</label>
                    {{ form.vehicle_type(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800") }}
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700">{{ form.license_plate.label }}</label>
                    {{ form.license_plate(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800") }}
                </div>
            </div>
            {% endif %}

            <!-- Campos SOLO para Negocios -->
            {% if selected_role == 'business' %}
            <div class="mt-6 border-t pt-4">
                <h3 class="text-xl font-semibold text-gray-700 mb-4">Información del Negocio</h3>

                <div class="mb-5">
                    <label class="block text-sm font-medium text-gray-700">{{ form.business_name.label }}</label>
                    {{ form.business_name(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800") }}
                </div>

                <div class="mb-5">
                    <label class="block text-sm font-medium text-gray-700">{{ form.business_address.label }}</label>
                    {{ form.business_address(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800") }}
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700">{{ form.business_description.label }}</label>
                    {{ form.business_description(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800", rows="4") }}
                </div>
            </div>
            {% endif %}

            <div class="mb-6 flex items-center">
                <input type="checkbox" required class="h-4 w-4 text-blue-600 border-gray-300 rounded">
                <label class="ml-2 block text-sm text-gray-700">
                    Acepto los <a href="#" class="text-blue-600 hover:underline font-semibold">Términos y Condiciones</a>.
                </label>
            </div>

            <button type="submit"
                class="w-full mt-6 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition font-semibold text-lg shadow-md">
                Crear mi Cuenta
            </button>
        </form>

        <p class="text-center text-gray-600 mt-6">
            ¿Ya tienes una cuenta?
            <a href="{{ url_for('public.login') }}" class="text-blue-600 hover:underline font-semibold">
                Inicia Sesión
            </a>
        </p>
    </div>
</div>
{% endblock %}